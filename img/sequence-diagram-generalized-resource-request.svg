<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="1402px" preserveAspectRatio="none" style="width:1970px;height:1402px;background:#FFFFFF;" version="1.1" viewBox="0 0 1970 1402" width="1970px" zoomAndPan="magnify"><defs/><g><rect fill="#DDDDDD" height="1383.1523" style="stroke:#181818;stroke-width:0.5;" width="929.2026" x="21" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="164.4551" x="401.2314" y="18.5684">Requesting organization</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="81.6753" x="401.2314" y="33.8789">(HIS or ECD)</text><rect fill="#DDDDDD" height="1383.1523" style="stroke:#181818;stroke-width:0.5;" width="790.0635" x="1152.8701" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="176.5156" x="1459.644" y="18.5684">Custodian organization 'Y'</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="81.6753" x="1459.644" y="33.8789">(HIS or ECD)</text><g><title>XIS</title><rect fill="#FFFFFF" height="1228.7324" style="stroke:#181818;stroke-width:1;" width="10" x="435.8687" y="148.4199"/></g><g><title>Nuts-node</title><rect fill="#FFFFFF" height="110.5527" style="stroke:#181818;stroke-width:1;" width="10" x="897.5005" y="365.5938"/></g><g><title>Nuts-node</title><rect fill="#FFFFFF" height="93.9316" style="stroke:#181818;stroke-width:1;" width="10" x="897.5005" y="545.7676"/></g><g><title>Nuts-node</title><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1;" width="10" x="1195.5723" y="773.9414"/></g><g><title>Nuts-node</title><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1;" width="10" x="1195.5723" y="1165.9785"/></g><g><title>PEP</title><rect fill="#FFFFFF" height="219.4844" style="stroke:#181818;stroke-width:1;" width="10" x="1651.5083" y="729.3203"/></g><g><title>PEP</title><rect fill="#FFFFFF" height="219.4844" style="stroke:#181818;stroke-width:1;" width="10" x="1651.5083" y="1121.3574"/></g><g><title>Fhir</title><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1;" width="10" x="1913.9487" y="890.1836"/></g><g><title>Fhir</title><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1;" width="10" x="1913.9487" y="1282.2207"/></g><rect fill="none" height="266.1055" style="stroke:#000000;stroke-width:1.5;" width="1535.2334" x="413.7002" y="1082.7363"/><g><title>Healthcare professional</title><rect fill="#000000" fill-opacity="0.00000" height="1278.043" width="8" x="104.0625" y="117.1094"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="108" x2="108" y1="117.1094" y2="1395.1523"/></g><g><title>XIS</title><rect fill="#000000" fill-opacity="0.00000" height="1278.043" width="8" x="436.8687" y="117.1094"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="440.7002" x2="440.7002" y1="117.1094" y2="1395.1523"/></g><g><title>Nuts-node</title><rect fill="#000000" fill-opacity="0.00000" height="1278.043" width="8" x="898.5005" y="117.1094"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="901.7983" x2="901.7983" y1="117.1094" y2="1395.1523"/></g><g><title>Nuts-node</title><rect fill="#000000" fill-opacity="0.00000" height="1278.043" width="8" x="1196.5723" y="117.1094"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1199.8701" x2="1199.8701" y1="117.1094" y2="1395.1523"/></g><g><title>PEP</title><rect fill="#000000" fill-opacity="0.00000" height="1278.043" width="8" x="1652.5083" y="117.1094"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1656.0083" x2="1656.0083" y1="117.1094" y2="1395.1523"/></g><g><title>Fhir</title><rect fill="#000000" fill-opacity="0.00000" height="1278.043" width="8" x="1914.9487" y="117.1094"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1917.9639" x2="1917.9639" y1="117.1094" y2="1395.1523"/></g><g class="participant participant-head" data-participant="User"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="160.125" x="25" y="114.1563">Healthcare professional</text><ellipse cx="108.0625" cy="49.1211" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M108.0625,57.1211 L108.0625,84.1211 M95.0625,65.1211 L121.0625,65.1211 M108.0625,84.1211 L95.0625,99.1211 M108.0625,84.1211 L121.0625,99.1211" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-head" data-participant="req"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="34.3369" x="423.7002" y="85.6211"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="20.3369" x="430.7002" y="106.1563">XIS</text></g><g class="participant participant-head" data-participant="rn"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="87.4043" x="858.7983" y="85.6211"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73.4043" x="865.7983" y="106.1563">Nuts-node</text></g><g class="participant participant-head" data-participant="cn"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="87.4043" x="1156.8701" y="85.6211"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73.4043" x="1163.8701" y="106.1563">Nuts-node</text></g><g class="participant participant-head" data-participant="PEP"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="23.0645" x="1641.9761" y="114.1563">PEP</text><path d="M1636.0083,72.6211 L1636.0083,96.6211 M1636.0083,84.6211 L1653.0083,84.6211" fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="1665.0083" cy="84.6211" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-head" data-participant="Fhir"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="39.9697" x="1898.9639" y="85.6211"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="25.9697" x="1905.9639" y="106.1563">Fhir</text></g><g><title>XIS</title><rect fill="#FFFFFF" height="1228.7324" style="stroke:#181818;stroke-width:1;" width="10" x="435.8687" y="148.4199"/></g><g><title>Nuts-node</title><rect fill="#FFFFFF" height="110.5527" style="stroke:#181818;stroke-width:1;" width="10" x="897.5005" y="365.5938"/></g><g><title>Nuts-node</title><rect fill="#FFFFFF" height="93.9316" style="stroke:#181818;stroke-width:1;" width="10" x="897.5005" y="545.7676"/></g><g><title>Nuts-node</title><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1;" width="10" x="1195.5723" y="773.9414"/></g><g><title>Nuts-node</title><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1;" width="10" x="1195.5723" y="1165.9785"/></g><g><title>PEP</title><rect fill="#FFFFFF" height="219.4844" style="stroke:#181818;stroke-width:1;" width="10" x="1651.5083" y="729.3203"/></g><g><title>PEP</title><rect fill="#FFFFFF" height="219.4844" style="stroke:#181818;stroke-width:1;" width="10" x="1651.5083" y="1121.3574"/></g><g><title>Fhir</title><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1;" width="10" x="1913.9487" y="890.1836"/></g><g><title>Fhir</title><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1;" width="10" x="1913.9487" y="1282.2207"/></g><g class="message" data-participant-1="User" data-participant-2="req"><polygon fill="#181818" points="423.8687,144.4199,433.8687,148.4199,423.8687,152.4199,427.8687,148.4199" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="108.0625" x2="429.8687" y1="148.4199" y2="148.4199"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8.5757" x="115.0625" y="143.6777">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="38.9619" x="127.6382" y="143.6777">Log in</text></g><g class="message" data-participant-1="req" data-participant-2="req"><line style="stroke:#181818;stroke-width:1;" x1="445.8687" x2="487.8687" y1="193.041" y2="193.041"/><line style="stroke:#181818;stroke-width:1;" x1="487.8687" x2="487.8687" y1="193.041" y2="206.041"/><line style="stroke:#181818;stroke-width:1;" x1="446.8687" x2="487.8687" y1="206.041" y2="206.041"/><polygon fill="#181818" points="456.8687,202.041,446.8687,206.041,456.8687,210.041,452.8687,206.041" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8.5757" x="452.8687" y="180.6436">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128.3115" x="465.4443" y="172.9883">Create User session,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="339.4536" x="465.4443" y="188.2988">User info needed for NutsEmployeeCredential (step 7)</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1963.9336" x="0" y="234.6963"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1963.9336" y1="234.6963" y2="234.6963"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1963.9336" y1="237.6963" y2="237.6963"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="159.0884" x="902.4226" y="224.041"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="140.8037" x="908.4226" y="240.6094">Later in User session</text><g class="message" data-participant-1="User" data-participant-2="req"><polygon fill="#181818" points="423.8687,274.6621,433.8687,278.6621,423.8687,282.6621,427.8687,278.6621" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="108.0625" x2="429.8687" y1="278.6621" y2="278.6621"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8.5757" x="115.0625" y="273.9199">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="291.2305" x="127.6382" y="273.9199">request information for Patient at Custodian Y</text></g><g class="message" data-participant-1="req" data-participant-2="req"><line style="stroke:#181818;stroke-width:1;" x1="445.8687" x2="487.8687" y1="307.9727" y2="307.9727"/><line style="stroke:#181818;stroke-width:1;" x1="487.8687" x2="487.8687" y1="307.9727" y2="320.9727"/><line style="stroke:#181818;stroke-width:1;" x1="446.8687" x2="487.8687" y1="320.9727" y2="320.9727"/><polygon fill="#181818" points="456.8687,316.9727,446.8687,320.9727,456.8687,324.9727,452.8687,320.9727" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8.5757" x="452.8687" y="303.2305">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="411.6582" x="465.4443" y="303.2305">Resolve Patient BSN, and Custodian_URA for patient if it is known</text></g><g class="message" data-participant-1="req" data-participant-2="rn"><polygon fill="#181818" points="885.5005,361.5938,895.5005,365.5938,885.5005,369.5938,889.5005,365.5938" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="445.8687" x2="891.5005" y1="365.5938" y2="365.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8.5757" x="452.8687" y="353.1963">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="208.5142" x="465.4443" y="345.541">Search for custodian in discovery</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="240.8936" x="465.4443" y="360.8516">Get /internal/discovery/v1/{serviceID}</text></g><path d="M912,378.5938 L912,449.5938 L1284,449.5938 L1284,388.5938 L1274,378.5938 L912,378.5938" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1274,378.5938 L1274,388.5938 L1284,388.5938 L1274,378.5938" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="243.2104" x="918" y="396.1621">Exact search is up to the implementer.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107.0596" x="918" y="411.4727">Possible options:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="340.1646" x="922.1133" y="426.7832">- Return everything from the service and let User pick</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="346.9121" x="922.1133" y="442.0938">- Let Nuts-node filter on Custodian_URA of the patient</text><g class="message" data-participant-1="rn" data-participant-2="req"><polygon fill="#181818" points="456.8687,472.1465,446.8687,476.1465,456.8687,480.1465,452.8687,476.1465" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="450.8687" x2="901.5005" y1="476.1465" y2="476.1465"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8.5757" x="462.8687" y="471.4043">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="263.0723" x="475.4443" y="471.4043">Found Organization Y (authz_url, fhir_url)</text></g><g class="message" data-participant-1="req" data-participant-2="rn"><polygon fill="#181818" points="885.5005,541.7676,895.5005,545.7676,885.5005,549.7676,889.5005,545.7676" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="445.8687" x2="891.5005" y1="545.7676" y2="545.7676"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8.5757" x="452.8687" y="533.3701">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106.4756" x="465.4443" y="525.7148">Get access token</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="420.0562" x="465.4443" y="541.0254">POST /internal/auth/v2/{subjectID}/request-service-access-token</text></g><g class="message" data-participant-1="rn" data-participant-2="cn"><polygon fill="#181818" points="918.5005,571.0781,908.5005,575.0781,918.5005,579.0781,914.5005,575.0781" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="1188.5723,571.0781,1198.5723,575.0781,1188.5723,579.0781,1192.5723,575.0781" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="912.5005" x2="1194.5723" y1="575.0781" y2="575.0781"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8.5757" x="924.5005" y="570.3359">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="256.4961" x="937.0762" y="570.3359">nuts-nodes handle access token request</text></g><path d="M912,588.0781 L912,613.0781 L1248,613.0781 L1248,598.0781 L1238,588.0781 L912,588.0781" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1238,588.0781 L1238,598.0781 L1248,598.0781 L1238,588.0781" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="315.8911" x="918" y="605.6465">uses X509Credential and NutsEmployeeCredential</text><g class="message" data-participant-1="rn" data-participant-2="req"><polygon fill="#181818" points="456.8687,635.6992,446.8687,639.6992,456.8687,643.6992,452.8687,639.6992" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="450.8687" x2="901.5005" y1="639.6992" y2="639.6992"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8.5757" x="462.8687" y="634.957">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82.6528" x="475.4443" y="634.957">Access token</text></g><path d="M450,677.6992 L450,702.6992 L722,702.6992 L722,687.6992 L712,677.6992 L450,677.6992" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M712,677.6992 L712,687.6992 L722,687.6992 L712,677.6992" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="251.0879" x="456" y="695.2676">Search based on BSN in body of request</text><g class="message" data-participant-1="req" data-participant-2="PEP"><polygon fill="#181818" points="1639.5083,725.3203,1649.5083,729.3203,1639.5083,733.3203,1643.5083,729.3203" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="445.8687" x2="1645.5083" y1="729.3203" y2="729.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1514" x="452.8687" y="724.5781">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169.749" x="474.02" y="724.5781">POST /fhir/Patient/_search</text></g><g class="message" data-participant-1="PEP" data-participant-2="cn"><polygon fill="#181818" points="1216.5723,769.9414,1206.5723,773.9414,1216.5723,777.9414,1212.5723,773.9414" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1210.5723" x2="1650.5083" y1="773.9414" y2="773.9414"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1514" x="1222.5723" y="761.5439">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148.5415" x="1243.7236" y="753.8887">introspect access token</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="302.4023" x="1243.7236" y="769.1992">POST /internal/auth/v2/accesstoken/introspect</text></g><g class="message" data-participant-1="cn" data-participant-2="PEP"><polygon fill="#181818" points="1639.5083,799.252,1649.5083,803.252,1639.5083,807.252,1643.5083,803.252" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1200.5723" x2="1645.5083" y1="803.252" y2="803.252"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1514" x="1207.5723" y="798.5098">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="400.7847" x="1228.7236" y="798.5098">valid token + requesting_URA + USER{name,userRole,identifier}</text></g><g class="message" data-participant-1="PEP" data-participant-2="PEP"><line style="stroke:#181818;stroke-width:1;" x1="1661.5083" x2="1703.5083" y1="847.873" y2="847.873"/><line style="stroke:#181818;stroke-width:1;" x1="1703.5083" x2="1703.5083" y1="847.873" y2="860.873"/><line style="stroke:#181818;stroke-width:1;" x1="1662.5083" x2="1703.5083" y1="860.873" y2="860.873"/><polygon fill="#181818" points="1672.5083,856.873,1662.5083,860.873,1672.5083,864.873,1668.5083,860.873" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1514" x="1668.5083" y="835.4756">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86.3345" x="1689.6597" y="827.8203">Authorization</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207.2891" x="1689.6597" y="843.1309">(Consent, Care relationship etc..)</text></g><g class="message" data-participant-1="PEP" data-participant-2="Fhir"><polygon fill="#181818" points="1901.9487,886.1836,1911.9487,890.1836,1901.9487,894.1836,1905.9487,890.1836" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1661.5083" x2="1907.9487" y1="890.1836" y2="890.1836"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1514" x="1668.5083" y="885.4414">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161.916" x="1689.6597" y="885.4414">POST /fhir/Patient?search</text></g><g class="message" data-participant-1="Fhir" data-participant-2="PEP"><polygon fill="#181818" points="1672.5083,915.4941,1662.5083,919.4941,1672.5083,923.4941,1668.5083,919.4941" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1666.5083" x2="1917.9487" y1="919.4941" y2="919.4941"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1514" x="1678.5083" y="914.752">15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="193.5146" x="1699.6597" y="914.752">: Patient Fhir resource (with id)</text></g><g class="message" data-participant-1="PEP" data-participant-2="req"><polygon fill="#181818" points="456.8687,944.8047,446.8687,948.8047,456.8687,952.8047,452.8687,948.8047" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="450.8687" x2="1655.5083" y1="948.8047" y2="948.8047"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1514" x="462.8687" y="944.0625">16</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="193.5146" x="484.02" y="944.0625">: Patient Fhir resource (with id)</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1963.9336" x="0" y="1002.46"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1963.9336" y1="1002.46" y2="1002.46"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1963.9336" y1="1005.46" y2="1005.46"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="182.9429" x="890.4954" y="991.8047"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="164.6582" x="896.4954" y="1008.373">Retrieve other resources</text><path d="M450,1030.1152 L450,1070.1152 L727,1070.1152 L727,1040.1152 L717,1030.1152 L450,1030.1152" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M717,1030.1152 L717,1040.1152 L727,1040.1152 L717,1030.1152" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184.9644" x="456" y="1047.6836">Other resources are gathered</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="256.6484" x="456" y="1062.9941">based on internal patient id of custodian</text><path d="M413.7002,1082.7363 L488.147,1082.7363 L488.147,1090.0469 L478.147,1100.0469 L413.7002,1100.0469 L413.7002,1082.7363" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="266.1055" style="stroke:#000000;stroke-width:1.5;" width="1535.2334" x="413.7002" y="1082.7363"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.4468" x="428.7002" y="1096.3047">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="192.5698" x="503.147" y="1095.3711">[For each resource except Patient]</text><g class="message" data-participant-1="req" data-participant-2="PEP"><polygon fill="#181818" points="1639.5083,1117.3574,1649.5083,1121.3574,1639.5083,1125.3574,1643.5083,1121.3574" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="445.8687" x2="1645.5083" y1="1121.3574" y2="1121.3574"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1514" x="452.8687" y="1116.6152">17</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207.6191" x="474.02" y="1116.6152">GET /fhir/{resource}?patient={id}</text></g><g class="message" data-participant-1="PEP" data-participant-2="cn"><polygon fill="#181818" points="1216.5723,1161.9785,1206.5723,1165.9785,1216.5723,1169.9785,1212.5723,1165.9785" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1210.5723" x2="1650.5083" y1="1165.9785" y2="1165.9785"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1514" x="1222.5723" y="1153.5811">18</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148.5415" x="1243.7236" y="1145.9258">introspect access token</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="302.4023" x="1243.7236" y="1161.2363">POST /internal/auth/v2/accesstoken/introspect</text></g><g class="message" data-participant-1="cn" data-participant-2="PEP"><polygon fill="#181818" points="1639.5083,1191.2891,1649.5083,1195.2891,1639.5083,1199.2891,1643.5083,1195.2891" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1200.5723" x2="1645.5083" y1="1195.2891" y2="1195.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1514" x="1207.5723" y="1190.5469">19</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="400.7847" x="1228.7236" y="1190.5469">valid token + requesting_URA + USER{name,userRole,identifier}</text></g><g class="message" data-participant-1="PEP" data-participant-2="PEP"><line style="stroke:#181818;stroke-width:1;" x1="1661.5083" x2="1703.5083" y1="1239.9102" y2="1239.9102"/><line style="stroke:#181818;stroke-width:1;" x1="1703.5083" x2="1703.5083" y1="1239.9102" y2="1252.9102"/><line style="stroke:#181818;stroke-width:1;" x1="1662.5083" x2="1703.5083" y1="1252.9102" y2="1252.9102"/><polygon fill="#181818" points="1672.5083,1248.9102,1662.5083,1252.9102,1672.5083,1256.9102,1668.5083,1252.9102" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1514" x="1668.5083" y="1227.5127">20</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86.3345" x="1689.6597" y="1219.8574">Authorization</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207.2891" x="1689.6597" y="1235.168">(Consent, Care relationship etc..)</text></g><g class="message" data-participant-1="PEP" data-participant-2="Fhir"><polygon fill="#181818" points="1901.9487,1278.2207,1911.9487,1282.2207,1901.9487,1286.2207,1905.9487,1282.2207" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1661.5083" x2="1907.9487" y1="1282.2207" y2="1282.2207"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1514" x="1668.5083" y="1277.4785">21</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207.6191" x="1689.6597" y="1277.4785">GET /fhir/{resource}?patient={id}</text></g><g class="message" data-participant-1="Fhir" data-participant-2="PEP"><polygon fill="#181818" points="1672.5083,1307.5313,1662.5083,1311.5313,1672.5083,1315.5313,1668.5083,1311.5313" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1666.5083" x2="1917.9487" y1="1311.5313" y2="1311.5313"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1514" x="1678.5083" y="1306.7891">22</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="90.9175" x="1699.6597" y="1306.7891">: Fhir resource</text></g><g class="message" data-participant-1="PEP" data-participant-2="req"><polygon fill="#181818" points="456.8687,1336.8418,446.8687,1340.8418,456.8687,1344.8418,452.8687,1340.8418" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="450.8687" x2="1655.5083" y1="1340.8418" y2="1340.8418"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1514" x="462.8687" y="1336.0996">23</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93.8184" x="484.02" y="1336.0996">: Fhir Resource</text></g><g class="message" data-participant-1="req" data-participant-2="User"><polygon fill="#181818" points="119.0625,1373.1523,109.0625,1377.1523,119.0625,1381.1523,115.0625,1377.1523" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="113.0625" x2="439.8687" y1="1377.1523" y2="1377.1523"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1514" x="125.0625" y="1372.4102">24</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="227.0747" x="146.2139" y="1372.4102">Display external Patient information</text></g><!--SRC=[jPPhRzf858Q_-rSSvKk3mA5RQRLQL5grX5wag46maHefKZJO1pmRC-FEZ6dI9FzztnbiOwEaKhMxVE0odEipxpcGoPHffRLRwjj8b4whShDa4zaRgGfXn8RUwzkPI5EfrlJgPHJ1ZkRyhMJh_94sQw7a3-6aLdIbZZzzNk2CffFJNYGIXxT7drZaBak4OIgCNh6ri1Nv4GbB5nQvaCV9H1P2EVeAVvmR_jOvFlfIEXihdN9mCofYbPAlULVHfBHEfrAeRa4lBbySrFIJe8b2g5AbmjpHR3hhc7x8f6bI-g8fVkEBxFTfH6TwJL95-5YTucnYM3WE_P7TjJm0d_1PgfKcnPno2lI6V1dJJP7hEsRufQoS53aTMyS5_T6Bel6OpX3DUtOYqdWSjQiP-IT_Co65sUmW-1Gpl4LO4gw5wZ8YFFPbZt2nLkTRRipVBxuCIA3jnkdwOlukH2mg4xaYYMTBDqf_Lr4dfEhtHxHWOP8i-2HDQZIIIfleBGFsbVh8ZePIeKK8OzXyCzp-Dhn7UrkPyEVJnn3RFvG6MYFNcIEzGfeHJMyXDc09gL1CMP3Jv38c2R2yOH_x19bc6kIMEPCkF1mxkb8KeszN6aNiaxhCwtfbz2RuL-a3XHnb1jo5J6w2unbE6XNHIkR-bi2yomj5-b0LigODP8mhmSJnY3vuyT5vMx-NT8oPp7vSboOVq0eYzEzw8SB3myCJj3r9aIJG1m3Si9_9sVdYhnPT7t2uVGMmvV9lJXp03YlPn5MpyIv272AqottjwqqKzAtgfYrbG0EWdQnLm6Tl315AY9Y-_lxopvRaFUIdf-49Q76CAEzQMRjO3b9wULTIN0gBoGDUoDihSQdJkygcARg2YZtWgUuGUlx3QZI6rpkn1MDOKG0JrW586sqBeEqmUVOYTaR1PhZtRGA3EIA7PhSYbsb5k5-N2xK6aVNfOZ6TtoknuG7OchdEUI03lfLayzYk52z0X_pQj7Rt1FC0ym5D_Ausd8TlR2OBOfUSdFJQ8Vn6V1hDsnOP4mPhr2mKxuL3gqk3cJh-BXt6DUtzacrppNZ1PiJi6ed99OqPsplOi1oV4SBvWQdlToty8OHnfHg1r7UrttQfZz7iiH0_rxh0y1fY0N4r1VDjmeMhkzdhjoEiZzCQtdtj-FYsIZQ-b-b-v_slEZjCyfzgxg3wVwEzWr2r1d-DOgspZhwUjvYtBVnV07_VuKFuANWTDmlyLDeY5tUu-KerjP9RlyRHFm00]--></g></svg>