<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="1415px" preserveAspectRatio="none" style="width:1975px;height:1415px;background:#FFFFFF;" version="1.1" viewBox="0 0 1975 1415" width="1975px" zoomAndPan="magnify"><defs/><g><rect fill="#DDDDDD" height="1396.1523" style="stroke:#181818;stroke-width:0.5;" width="929.2026" x="21" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="164.4551" x="401.2314" y="18.5684">Requesting organization</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="81.6753" x="401.2314" y="33.8789">(HIS or ECD)</text><rect fill="#DDDDDD" height="1396.1523" style="stroke:#181818;stroke-width:0.5;" width="790.0635" x="1157.8701" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="176.5156" x="1464.644" y="18.5684">Custodian organization 'Y'</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="81.6753" x="1464.644" y="33.8789">(HIS or ECD)</text><g><title>XIS</title><rect fill="#FFFFFF" height="1241.7324" style="stroke:#181818;stroke-width:1;" width="10" x="435.8687" y="148.4199"/></g><g><title>Nuts-node</title><rect fill="#FFFFFF" height="110.5527" style="stroke:#181818;stroke-width:1;" width="10" x="897.5005" y="365.5938"/></g><g><title>Nuts-node</title><rect fill="#FFFFFF" height="106.9316" style="stroke:#181818;stroke-width:1;" width="10" x="897.5005" y="545.7676"/></g><g><title>Nuts-node</title><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1;" width="10" x="1200.5723" y="786.9414"/></g><g><title>Nuts-node</title><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1;" width="10" x="1200.5723" y="1178.9785"/></g><g><title>PEP</title><rect fill="#FFFFFF" height="219.4844" style="stroke:#181818;stroke-width:1;" width="10" x="1656.5083" y="742.3203"/></g><g><title>PEP</title><rect fill="#FFFFFF" height="219.4844" style="stroke:#181818;stroke-width:1;" width="10" x="1656.5083" y="1134.3574"/></g><g><title>Fhir</title><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1;" width="10" x="1918.9487" y="903.1836"/></g><g><title>Fhir</title><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1;" width="10" x="1918.9487" y="1295.2207"/></g><rect fill="none" height="266.1055" style="stroke:#000000;stroke-width:1.5;" width="1540.2334" x="413.7002" y="1095.7363"/><g><title>Healthcare professional</title><rect fill="#000000" fill-opacity="0.00000" height="1291.043" width="8" x="104.0625" y="117.1094"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="108" x2="108" y1="117.1094" y2="1408.1523"/></g><g><title>XIS</title><rect fill="#000000" fill-opacity="0.00000" height="1291.043" width="8" x="436.8687" y="117.1094"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="440.7002" x2="440.7002" y1="117.1094" y2="1408.1523"/></g><g><title>Nuts-node</title><rect fill="#000000" fill-opacity="0.00000" height="1291.043" width="8" x="898.5005" y="117.1094"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="901.7983" x2="901.7983" y1="117.1094" y2="1408.1523"/></g><g><title>Nuts-node</title><rect fill="#000000" fill-opacity="0.00000" height="1291.043" width="8" x="1201.5723" y="117.1094"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1204.8701" x2="1204.8701" y1="117.1094" y2="1408.1523"/></g><g><title>PEP</title><rect fill="#000000" fill-opacity="0.00000" height="1291.043" width="8" x="1657.5083" y="117.1094"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1661.0083" x2="1661.0083" y1="117.1094" y2="1408.1523"/></g><g><title>Fhir</title><rect fill="#000000" fill-opacity="0.00000" height="1291.043" width="8" x="1919.9487" y="117.1094"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1922.9639" x2="1922.9639" y1="117.1094" y2="1408.1523"/></g><g class="participant participant-head" data-participant="User"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="160.125" x="25" y="114.1563">Healthcare professional</text><ellipse cx="108.0625" cy="49.1211" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M108.0625,57.1211 L108.0625,84.1211 M95.0625,65.1211 L121.0625,65.1211 M108.0625,84.1211 L95.0625,99.1211 M108.0625,84.1211 L121.0625,99.1211" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-head" data-participant="req"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="34.3369" x="423.7002" y="85.6211"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="20.3369" x="430.7002" y="106.1563">XIS</text></g><g class="participant participant-head" data-participant="rn"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="87.4043" x="858.7983" y="85.6211"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73.4043" x="865.7983" y="106.1563">Nuts-node</text></g><g class="participant participant-head" data-participant="cn"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="87.4043" x="1161.8701" y="85.6211"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73.4043" x="1168.8701" y="106.1563">Nuts-node</text></g><g class="participant participant-head" data-participant="PEP"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="23.0645" x="1646.9761" y="114.1563">PEP</text><path d="M1641.0083,72.6211 L1641.0083,96.6211 M1641.0083,84.6211 L1658.0083,84.6211" fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="1670.0083" cy="84.6211" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-head" data-participant="Fhir"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="39.9697" x="1903.9639" y="85.6211"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="25.9697" x="1910.9639" y="106.1563">Fhir</text></g><g><title>XIS</title><rect fill="#FFFFFF" height="1241.7324" style="stroke:#181818;stroke-width:1;" width="10" x="435.8687" y="148.4199"/></g><g><title>Nuts-node</title><rect fill="#FFFFFF" height="110.5527" style="stroke:#181818;stroke-width:1;" width="10" x="897.5005" y="365.5938"/></g><g><title>Nuts-node</title><rect fill="#FFFFFF" height="106.9316" style="stroke:#181818;stroke-width:1;" width="10" x="897.5005" y="545.7676"/></g><g><title>Nuts-node</title><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1;" width="10" x="1200.5723" y="786.9414"/></g><g><title>Nuts-node</title><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1;" width="10" x="1200.5723" y="1178.9785"/></g><g><title>PEP</title><rect fill="#FFFFFF" height="219.4844" style="stroke:#181818;stroke-width:1;" width="10" x="1656.5083" y="742.3203"/></g><g><title>PEP</title><rect fill="#FFFFFF" height="219.4844" style="stroke:#181818;stroke-width:1;" width="10" x="1656.5083" y="1134.3574"/></g><g><title>Fhir</title><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1;" width="10" x="1918.9487" y="903.1836"/></g><g><title>Fhir</title><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1;" width="10" x="1918.9487" y="1295.2207"/></g><g class="message" data-participant-1="User" data-participant-2="req"><polygon fill="#181818" points="423.8687,144.4199,433.8687,148.4199,423.8687,152.4199,427.8687,148.4199" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="108.0625" x2="429.8687" y1="148.4199" y2="148.4199"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8.5757" x="115.0625" y="143.6777">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="38.9619" x="127.6382" y="143.6777">Log in</text></g><g class="message" data-participant-1="req" data-participant-2="req"><line style="stroke:#181818;stroke-width:1;" x1="445.8687" x2="487.8687" y1="193.041" y2="193.041"/><line style="stroke:#181818;stroke-width:1;" x1="487.8687" x2="487.8687" y1="193.041" y2="206.041"/><line style="stroke:#181818;stroke-width:1;" x1="446.8687" x2="487.8687" y1="206.041" y2="206.041"/><polygon fill="#181818" points="456.8687,202.041,446.8687,206.041,456.8687,210.041,452.8687,206.041" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8.5757" x="452.8687" y="180.6436">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128.3115" x="465.4443" y="172.9883">Create User session,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="339.4536" x="465.4443" y="188.2988">User info needed for NutsEmployeeCredential (step 7)</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1968.9336" x="0" y="234.6963"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1968.9336" y1="234.6963" y2="234.6963"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1968.9336" y1="237.6963" y2="237.6963"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="159.0884" x="904.9226" y="224.041"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="140.8037" x="910.9226" y="240.6094">Later in User session</text><g class="message" data-participant-1="User" data-participant-2="req"><polygon fill="#181818" points="423.8687,274.6621,433.8687,278.6621,423.8687,282.6621,427.8687,278.6621" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="108.0625" x2="429.8687" y1="278.6621" y2="278.6621"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8.5757" x="115.0625" y="273.9199">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="291.2305" x="127.6382" y="273.9199">request information for Patient at Custodian Y</text></g><g class="message" data-participant-1="req" data-participant-2="req"><line style="stroke:#181818;stroke-width:1;" x1="445.8687" x2="487.8687" y1="307.9727" y2="307.9727"/><line style="stroke:#181818;stroke-width:1;" x1="487.8687" x2="487.8687" y1="307.9727" y2="320.9727"/><line style="stroke:#181818;stroke-width:1;" x1="446.8687" x2="487.8687" y1="320.9727" y2="320.9727"/><polygon fill="#181818" points="456.8687,316.9727,446.8687,320.9727,456.8687,324.9727,452.8687,320.9727" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8.5757" x="452.8687" y="303.2305">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="411.6582" x="465.4443" y="303.2305">Resolve Patient BSN, and Custodian_URA for patient if it is known</text></g><g class="message" data-participant-1="req" data-participant-2="rn"><polygon fill="#181818" points="885.5005,361.5938,895.5005,365.5938,885.5005,369.5938,889.5005,365.5938" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="445.8687" x2="891.5005" y1="365.5938" y2="365.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8.5757" x="452.8687" y="353.1963">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="208.5142" x="465.4443" y="345.541">Search for custodian in discovery</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="240.8936" x="465.4443" y="360.8516">Get /internal/discovery/v1/{serviceID}</text></g><path d="M912,378.5938 L912,449.5938 L1284,449.5938 L1284,388.5938 L1274,378.5938 L912,378.5938" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1274,378.5938 L1274,388.5938 L1284,388.5938 L1274,378.5938" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="243.2104" x="918" y="396.1621">Exact search is up to the implementer.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107.0596" x="918" y="411.4727">Possible options:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="340.1646" x="922.1133" y="426.7832">- Return everything from the service and let User pick</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="346.9121" x="922.1133" y="442.0938">- Let Nuts-node filter on Custodian_URA of the patient</text><g class="message" data-participant-1="rn" data-participant-2="req"><polygon fill="#181818" points="456.8687,472.1465,446.8687,476.1465,456.8687,480.1465,452.8687,476.1465" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="450.8687" x2="901.5005" y1="476.1465" y2="476.1465"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8.5757" x="462.8687" y="471.4043">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="263.0723" x="475.4443" y="471.4043">Found Organization Y (authz_url, fhir_url)</text></g><g class="message" data-participant-1="req" data-participant-2="rn"><polygon fill="#181818" points="885.5005,541.7676,895.5005,545.7676,885.5005,549.7676,889.5005,545.7676" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="445.8687" x2="891.5005" y1="545.7676" y2="545.7676"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8.5757" x="452.8687" y="533.3701">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106.4756" x="465.4443" y="525.7148">Get access token</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="420.0562" x="465.4443" y="541.0254">POST /internal/auth/v2/{subjectID}/request-service-access-token</text></g><g class="message" data-participant-1="rn" data-participant-2="rn"><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="907.5005" x2="949.5005" y1="575.0781" y2="575.0781"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="949.5005" x2="949.5005" y1="575.0781" y2="588.0781"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="908.5005" x2="949.5005" y1="588.0781" y2="588.0781"/><polygon fill="#181818" points="917.5005,571.0781,907.5005,575.0781,917.5005,579.0781,913.5005,575.0781" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="918.5005,584.0781,908.5005,588.0781,918.5005,592.0781,914.5005,588.0781" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8.5757" x="914.5005" y="570.3359">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="256.4961" x="927.0762" y="570.3359">nuts-nodes handle access token request</text></g><path d="M912,601.0781 L912,626.0781 L1248,626.0781 L1248,611.0781 L1238,601.0781 L912,601.0781" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1238,601.0781 L1238,611.0781 L1248,611.0781 L1238,601.0781" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="315.8911" x="918" y="618.6465">uses X509Credential and NutsEmployeeCredential</text><g class="message" data-participant-1="rn" data-participant-2="req"><polygon fill="#181818" points="456.8687,648.6992,446.8687,652.6992,456.8687,656.6992,452.8687,652.6992" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="450.8687" x2="901.5005" y1="652.6992" y2="652.6992"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8.5757" x="462.8687" y="647.957">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82.6528" x="475.4443" y="647.957">Access token</text></g><path d="M450,690.6992 L450,715.6992 L722,715.6992 L722,700.6992 L712,690.6992 L450,690.6992" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M712,690.6992 L712,700.6992 L722,700.6992 L712,690.6992" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="251.0879" x="456" y="708.2676">Search based on BSN in body of request</text><g class="message" data-participant-1="req" data-participant-2="PEP"><polygon fill="#181818" points="1644.5083,738.3203,1654.5083,742.3203,1644.5083,746.3203,1648.5083,742.3203" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="445.8687" x2="1650.5083" y1="742.3203" y2="742.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1514" x="452.8687" y="737.5781">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169.749" x="474.02" y="737.5781">POST /fhir/Patient/_search</text></g><g class="message" data-participant-1="PEP" data-participant-2="cn"><polygon fill="#181818" points="1221.5723,782.9414,1211.5723,786.9414,1221.5723,790.9414,1217.5723,786.9414" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1215.5723" x2="1655.5083" y1="786.9414" y2="786.9414"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1514" x="1227.5723" y="774.5439">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148.5415" x="1248.7236" y="766.8887">introspect access token</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="302.4023" x="1248.7236" y="782.1992">POST /internal/auth/v2/accesstoken/introspect</text></g><g class="message" data-participant-1="cn" data-participant-2="PEP"><polygon fill="#181818" points="1644.5083,812.252,1654.5083,816.252,1644.5083,820.252,1648.5083,816.252" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1205.5723" x2="1650.5083" y1="816.252" y2="816.252"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1514" x="1212.5723" y="811.5098">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="400.7847" x="1233.7236" y="811.5098">valid token + requesting_URA + USER{name,userRole,identifier}</text></g><g class="message" data-participant-1="PEP" data-participant-2="PEP"><line style="stroke:#181818;stroke-width:1;" x1="1666.5083" x2="1708.5083" y1="860.873" y2="860.873"/><line style="stroke:#181818;stroke-width:1;" x1="1708.5083" x2="1708.5083" y1="860.873" y2="873.873"/><line style="stroke:#181818;stroke-width:1;" x1="1667.5083" x2="1708.5083" y1="873.873" y2="873.873"/><polygon fill="#181818" points="1677.5083,869.873,1667.5083,873.873,1677.5083,877.873,1673.5083,873.873" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1514" x="1673.5083" y="848.4756">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86.3345" x="1694.6597" y="840.8203">Authorization</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207.2891" x="1694.6597" y="856.1309">(Consent, Care relationship etc..)</text></g><g class="message" data-participant-1="PEP" data-participant-2="Fhir"><polygon fill="#181818" points="1906.9487,899.1836,1916.9487,903.1836,1906.9487,907.1836,1910.9487,903.1836" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1666.5083" x2="1912.9487" y1="903.1836" y2="903.1836"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1514" x="1673.5083" y="898.4414">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161.916" x="1694.6597" y="898.4414">POST /fhir/Patient?search</text></g><g class="message" data-participant-1="Fhir" data-participant-2="PEP"><polygon fill="#181818" points="1677.5083,928.4941,1667.5083,932.4941,1677.5083,936.4941,1673.5083,932.4941" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1671.5083" x2="1922.9487" y1="932.4941" y2="932.4941"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1514" x="1683.5083" y="927.752">15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="193.5146" x="1704.6597" y="927.752">: Patient Fhir resource (with id)</text></g><g class="message" data-participant-1="PEP" data-participant-2="req"><polygon fill="#181818" points="456.8687,957.8047,446.8687,961.8047,456.8687,965.8047,452.8687,961.8047" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="450.8687" x2="1660.5083" y1="961.8047" y2="961.8047"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1514" x="462.8687" y="957.0625">16</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="193.5146" x="484.02" y="957.0625">: Patient Fhir resource (with id)</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1968.9336" x="0" y="1015.46"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1968.9336" y1="1015.46" y2="1015.46"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1968.9336" y1="1018.46" y2="1018.46"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="182.9429" x="892.9954" y="1004.8047"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="164.6582" x="898.9954" y="1021.373">Retrieve other resources</text><path d="M450,1043.1152 L450,1083.1152 L727,1083.1152 L727,1053.1152 L717,1043.1152 L450,1043.1152" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M717,1043.1152 L717,1053.1152 L727,1053.1152 L717,1043.1152" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184.9644" x="456" y="1060.6836">Other resources are gathered</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="256.6484" x="456" y="1075.9941">based on internal patient id of custodian</text><path d="M413.7002,1095.7363 L488.147,1095.7363 L488.147,1103.0469 L478.147,1113.0469 L413.7002,1113.0469 L413.7002,1095.7363" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="266.1055" style="stroke:#000000;stroke-width:1.5;" width="1540.2334" x="413.7002" y="1095.7363"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.4468" x="428.7002" y="1109.3047">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="192.5698" x="503.147" y="1108.3711">[For each resource except Patient]</text><g class="message" data-participant-1="req" data-participant-2="PEP"><polygon fill="#181818" points="1644.5083,1130.3574,1654.5083,1134.3574,1644.5083,1138.3574,1648.5083,1134.3574" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="445.8687" x2="1650.5083" y1="1134.3574" y2="1134.3574"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1514" x="452.8687" y="1129.6152">17</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207.6191" x="474.02" y="1129.6152">GET /fhir/{resource}?patient={id}</text></g><g class="message" data-participant-1="PEP" data-participant-2="cn"><polygon fill="#181818" points="1221.5723,1174.9785,1211.5723,1178.9785,1221.5723,1182.9785,1217.5723,1178.9785" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1215.5723" x2="1655.5083" y1="1178.9785" y2="1178.9785"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1514" x="1227.5723" y="1166.5811">18</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148.5415" x="1248.7236" y="1158.9258">introspect access token</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="302.4023" x="1248.7236" y="1174.2363">POST /internal/auth/v2/accesstoken/introspect</text></g><g class="message" data-participant-1="cn" data-participant-2="PEP"><polygon fill="#181818" points="1644.5083,1204.2891,1654.5083,1208.2891,1644.5083,1212.2891,1648.5083,1208.2891" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1205.5723" x2="1650.5083" y1="1208.2891" y2="1208.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1514" x="1212.5723" y="1203.5469">19</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="400.7847" x="1233.7236" y="1203.5469">valid token + requesting_URA + USER{name,userRole,identifier}</text></g><g class="message" data-participant-1="PEP" data-participant-2="PEP"><line style="stroke:#181818;stroke-width:1;" x1="1666.5083" x2="1708.5083" y1="1252.9102" y2="1252.9102"/><line style="stroke:#181818;stroke-width:1;" x1="1708.5083" x2="1708.5083" y1="1252.9102" y2="1265.9102"/><line style="stroke:#181818;stroke-width:1;" x1="1667.5083" x2="1708.5083" y1="1265.9102" y2="1265.9102"/><polygon fill="#181818" points="1677.5083,1261.9102,1667.5083,1265.9102,1677.5083,1269.9102,1673.5083,1265.9102" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1514" x="1673.5083" y="1240.5127">20</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86.3345" x="1694.6597" y="1232.8574">Authorization</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207.2891" x="1694.6597" y="1248.168">(Consent, Care relationship etc..)</text></g><g class="message" data-participant-1="PEP" data-participant-2="Fhir"><polygon fill="#181818" points="1906.9487,1291.2207,1916.9487,1295.2207,1906.9487,1299.2207,1910.9487,1295.2207" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1666.5083" x2="1912.9487" y1="1295.2207" y2="1295.2207"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1514" x="1673.5083" y="1290.4785">21</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207.6191" x="1694.6597" y="1290.4785">GET /fhir/{resource}?patient={id}</text></g><g class="message" data-participant-1="Fhir" data-participant-2="PEP"><polygon fill="#181818" points="1677.5083,1320.5313,1667.5083,1324.5313,1677.5083,1328.5313,1673.5083,1324.5313" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1671.5083" x2="1922.9487" y1="1324.5313" y2="1324.5313"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1514" x="1683.5083" y="1319.7891">22</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="90.9175" x="1704.6597" y="1319.7891">: Fhir resource</text></g><g class="message" data-participant-1="PEP" data-participant-2="req"><polygon fill="#181818" points="456.8687,1349.8418,446.8687,1353.8418,456.8687,1357.8418,452.8687,1353.8418" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="450.8687" x2="1660.5083" y1="1353.8418" y2="1353.8418"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1514" x="462.8687" y="1349.0996">23</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93.8184" x="484.02" y="1349.0996">: Fhir Resource</text></g><g class="message" data-participant-1="req" data-participant-2="User"><polygon fill="#181818" points="119.0625,1386.1523,109.0625,1390.1523,119.0625,1394.1523,115.0625,1390.1523" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="113.0625" x2="439.8687" y1="1390.1523" y2="1390.1523"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1514" x="125.0625" y="1385.4102">24</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="227.0747" x="146.2139" y="1385.4102">Display external Patient information</text></g><!--SRC=[jLRlQzj84FsklsB8byROYdk5upXHjxIE-mD2O-mBD108QsbixKNULNTNRj8a__kzNSkoP992kJjziANLp9kPDs_6pcN6jDJQBVHj92gdLRLUi8diZLIbC69Dx_NjL6IPL2jwzJAAO4Sp_bQnTVv8cvLGyeTmKYkwKiUVFiznHfFnQIyIgSFjqISMXSjJOPXAevTiBMn5SKJ2qeL5BCHnCfMbK8w-mX_dXhzrZe- -LCx6IcSSt8oAM6NaSzvcDAwiqvaKgflGYyiN1pdz13HLWAfK9imTJIVJZkc7N9ecf4-QuZS-oNwV4ZhJAv8gmcDzYhEnOU4ur4TsM_80_8HdgPQQ57F66QWtvDEOhCj2tp73BsFbf2Zes3ekwOzU58r6T0Oqxzb1fD4eQcT326oslGb1p7fBWmyonIs0IRWMMPSHuTeddg2rLXSRRipVpxyCIA3mnkdwOlOk89QrYLoInAUb6wM_gwW3gVhzXEOiJ9e7dxG9ZL8oQLEzOT1zfJwoew5KA1BI63PlXflVXlSeS2DJ_dpw6B3zfJJ8DNALEz9BX4beSWkvWPWG2ibK9JbDBcUIe9RNxB5F46cgmTsYODAb9yScLufYrEqgeuXzK9TxPI-DNWV_EdnWeK2QWV1IfZV1yGmdZOveAGlV9t3UvGj9UgYQigOCH8phriLnGX-y_EYyhU1BEiPKvZ-kArCCQ0aP-hjUG7XuU3XWEo7FeqXJw0Fbtx2VoUdv_AyMjnvkk7a5Mgl5tvmwq3giHHFNfSPRX3WWX0ZWLcwye8rg9_ywPAyWExMZm58Eea1l9uiwmBFz0q85KTFNtr_-sHe1J_dJq_4KXGczQyKC5XctC- -oTf23Lt-jr8Mm64sm3_LxeIvqTbVRD5NKd6DHU8blEVRj6TQJCxpUQZ4OmyeRfohi2xJ2Q5k2-mv9ptPgQnHiXdlV1XXD038-4jg8GcOrvVrTkX1pq62VBkQJsRqIQnw0R3FJ1Gzau7CfsJosCyKNs4HyRLhBVOnnWVc0ndwP6ox26vlBajYb9oUzDeHVcKzJyxR5Z0bpbpJxndlXqEhAOEIElqk7QSvwlsJRj1bVM9qORICnsAGnWdi76xRdCq8uFp3rzQw4FuGmhbGZa5slziimynZDcWluXTObPjiGn9Zl4-RRb4ktgsOlw8wmFavsvDtl71_Vri56zpBRhyJ_LMU7GVvJpHra_s-qTm2rq-2liRZJMKTVprlCsXR-FuBlTtW8lnIlusQ_dqfR5k8EdQzLirDowySw-WS0]--></g></svg>